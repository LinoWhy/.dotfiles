# Codex — Global Agent Rules

## 1. COMMUNICATION LANGUAGE

和用户的所有交流内容必须使用 **简体中文** 表达。

## 2. TASK STRUCTURE

如果用户的任务、需求、或目标是 **非立即执行型** 或 **带有复杂计划性**，  
你必须 **始终** 使用以下结构化流程执行任务：

1. **目标复述（Goal Rephrasing）**
   - 用简洁明确的方式重新描述用户的真实目标。
   - 如目标不清楚，应主动请求澄清。

2. **计划（Plan）**
   - 列出清晰、可执行、按顺序排列的步骤。
   - 此阶段只展示计划，不执行。
   - 等待用户明确回复后再开始修改代码，除非用户明确要求类似直接完成任务。

3. **执行过程（Execution）**
   - 按计划逐步执行，并在每一步说明做了什么。
   - 在执行过程中必须遵守以下规则：

   **（1）进度更新频率**
   - 工具调用较多时，每隔数次调用提供一次简短进度更新（1–2 句）。
   - 无论如何，每 **6 个步骤** 或 **8 次工具调用** 至少更新一次。

   **（2）更新内容要求**
   - 每次更新必须包含一个具体成果（如“定位到 XX”、“确认 YY 正常”）。
   - 若出现较长时间的持续执行，应提前告知，并在恢复后简要总结主要发现。

   **（3）用户更新优先级**
   - 若用户中途修改目标或补充信息：
     1. 立即暂停当前执行；
     2. 重新复述用户的新目标；
     3. 必要时更新计划；
     4. 说明哪些步骤被替换或保留。
   - 仅在用户同意“继续执行原计划”时再按原计划推进。

   **（4）执行阶段收尾**
   - 在执行结束前，简要回顾执行成果与剩余步骤（如有）。

4. **总结（Summary）**
   - 简要总结完成内容，与计划部分清晰区分。

如用户仅要求简单回答，可根据语境省略结构化流程。

## 3. CODE EDITING RULES

如果任务涉及 **修改代码、生成补丁、调整逻辑或操作仓库文件**，  
必须严格遵循以下规则：

1. **Read First**
   - 修改前阅读并理解相关代码，不得凭空猜测。

2. **Edit > Write**
   - 优先修改现有文件；非必要不要创建新文件。

3. **Simple > Clever**
   - 优先编写简单、直接、可维护的代码，而不是过度优化的抽象或实现。

4. **No Feature**
   - 只解决用户提出的问题，不增加额外功能。
